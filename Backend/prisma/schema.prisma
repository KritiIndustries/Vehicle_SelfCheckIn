datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Guard_Master {
  Guard_Id     Int      @id @default(autoincrement())
  Name         String   @db.VarChar(100)
  Mobile       String   @unique @db.VarChar(15)
  Active       Boolean  @default(true)
  OTP       String?
  OTP_Expiry  DateTime?

  Created_At   DateTime @default(now()) @db.DateTime2
  Updated_At   DateTime @updatedAt @db.DateTime2

  Verified_Documents Driver_Documents[]

  @@map("GUARD_MASTER")
}
model Security_Logs {
  id        Int      @id @default(autoincrement())
  userId    Int?
  ip        String?
  latitude  Float?
  longitude Float?
  distance  Float?
  reason    String?
  createdAt DateTime @default(now())
}

model Driver_Checkin {
  Id                     Int      @id @default(autoincrement())

  Do_No                  String   @db.VarChar(50)
  Vehicle_No             String   @db.VarChar(20)
  Driver_Name            String   @db.VarChar(100)
  Mobile                 String   @db.VarChar(15)

  Licence_Expiry_Date    DateTime? @db.Date
  Insurance_Number       String?   @db.VarChar(50)
  Insurance_Expiry_Date  DateTime? @db.Date
  Chassis_Number         String?   @db.VarChar(50)
  Rc_Expiry_Date         DateTime? @db.Date
  Fitness_Expiry_Date    DateTime? @db.Date

  Status                 String   @default("Pending") @db.VarChar(20)
  Zgp                    String?  @db.VarChar(50)

  Entry_Time             DateTime? @db.DateTime2
  Exit_Time              DateTime? @db.DateTime2

  Latitude               Decimal?  @db.Decimal(10,6)
  Longitude              Decimal?  @db.Decimal(10,6)


  Created_At             DateTime @default(now()) @db.DateTime2
  Updated_At             DateTime @updatedAt @db.DateTime2

  Documents              Driver_Documents[]

  @@map("DRIVER_CHECKIN")
  @@index([Do_No])
  @@index([Vehicle_No])
  @@index([Status])
}

model Driver_Documents {
  Id                   Int      @id @default(autoincrement())

  Driver_Checkin_Id    Int
  Doc_Type             String   @db.VarChar(50)
  Expiry_Date          DateTime? @db.Date
  Verified             Boolean   @default(false)
  Image_Path           String    @db.VarChar(255)

  Verified_By          Int?

  Driver_Checkin       Driver_Checkin @relation(fields: [Driver_Checkin_Id], references: [Id])
  Guard                Guard_Master?  @relation(fields: [Verified_By], references: [Guard_Id])

  Created_At           DateTime @default(now()) @db.DateTime2
  Updated_At           DateTime @updatedAt @db.DateTime2

  @@map("DRIVER_DOCUMENTS")
  @@index([Driver_Checkin_Id])
  @@index([Verified_By])
}

model Driver_Temp_Upload {
  Id          Int      @id @default(autoincrement())
  Session_Id  String   @db.VarChar(100)
  Doc_Type    String   @db.VarChar(50)
  Image_Path  String   @db.VarChar(255)
  Is_Selfie   Boolean  @default(false)
  Created_At  DateTime @default(now())

  @@index([Session_Id])
}